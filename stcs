if not game:IsLoaded() then game.Loaded:Wait() end

local MT = getrawmetatable(game)
local OldIndex = MT. __index
local OldNamecall = MT.__namecall

setreadonly(MT, false)
MT.__index = newcclosure(function(P, M, TH, TI, HB, SZ)
	if not checkcaller() and getnamecallmethod() then
		if tostring(P) == "Position" and tostring(M) == "Magnitude" then return end
		if tostring(HB) == "HumanoidRootPart" and tostring(SZ) == "Size" then return end
		if tostring(TH) == "Handle" then return end
		if tostring(TI) == "firetouchinterest" then return end
	end
	return OldIndex(P, M, TH, TI, HB, SZ)
end)

for _, v in next, getconnections(game:GetService("LogService").MessageOut) do v:Disable() end
for _, v in next, getconnections(game:GetService("ScriptContext").Error) do v:Disable() end
game:GetService("ScriptContext"):SetTimeout(0.1)
setreadonly(MT, true)

getgenv().set = {
	aim = {
		toggle = true,
		radius = 15
	},

	amp = {
		toggle = false,
		damage = 3
	}
}

local RunService = game:GetService("RunService")
local Players = game:GetService("Players")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

local zone = workspace.Terrain.Spawn:FindFirstChild("SafePlate")
if not zone then return end

local ZonePos = zone.Position
local ZoneSize = zone.Size
local area = Vector3.new(ZoneSize.X, 0, ZoneSize.Z) / 2

local XZ = {
	minX = ZonePos.X - area.X,
	maxX = ZonePos.X + area.X,
	minZ = ZonePos.Z - area.Z,
	maxZ = ZonePos.Z + area.Z
}

local UpdateCamAim = function()
	if not set.aim.toggle then return end

	local character = player.Character
	local rootpart = character and character:FindFirstChild("HumanoidRootPart")
	local humanoid = character and character:FindFirstChild("Humanoid")

	if not character or not rootpart or not humanoid then return end

	local position = rootpart.Position
	if position.X >= XZ.minX and position.X <= XZ.maxX and position.Z >= XZ.minZ and position.Z <= XZ.maxZ then return end

	for _, Player in pairs(Players:GetPlayers()) do
		if Player.Name ~= player.Name then

			local otherchar = Player.Character
			local otherroot = otherchar and otherchar:FindFirstChild("HumanoidRootPart")
			local otherhum = otherchar and otherchar:FindFirstChild("Humanoid")

			if not otherchar or not otherroot or not otherhum then continue end

			local pos = otherroot.Position
			if pos.X >= XZ.minX and pos.X <= XZ.maxX and pos.Z >= XZ.minZ and pos.Z <= XZ.maxZ then continue end

			if otherhum.Health <= 0 then continue end
			if humanoid.Health <= 0 then return end

			if otherroot then
				local distance = (otherroot.Position - rootpart.Position).Magnitude

				if distance <= set.aim.radius then
					local RightArm = otherchar and otherchar:FindFirstChild("Right Arm")
					if not RightArm then continue end

					local direction = Vector3.new(RightArm.Position.X - otherroot.Position.X, 0, RightArm.Position.Z - otherroot.Position.Z).Unit
					local lookat = Vector3.new(otherroot.Position.X, camera.CFrame.LookVector.Y, otherroot.Position.Z) + direction
					local NewCFrame = CFrame.new(camera.CFrame.Position, lookat)
					
					camera.CFrame = NewCFrame + Vector3.new(10, 0, 10)
					camera.CFrame = NewCFrame + Vector3.new(-10, 0, -10)
				end
			end
		end
	end
end

local ampx = function()
	if not set.amp.toggle then return end
	
	local Char = player.Character
	local Rootpart = Char and Char:FindFirstChild("HumanoidRootPart")
	local Humanoid = Char and Char:FindFirstChildOfClass("Humanoid")
	
	if not Char or not Rootpart or not Humanoid then return end
	
	local position = Rootpart.Position
	if position.X >= XZ.minX and position.X <= XZ.maxX and position.Z >= XZ.minZ and position.Z <= XZ.maxZ then return end
	
	for _, others in pairs(Players:GetPlayers()) do
		if others.Name ~= player.Name then

			local othersChar = others.Character
			local othersRootpart = othersChar and othersChar:FindFirstChild("HumanoidRootPart")
			local othersHumanoid = othersChar and othersChar:FindFirstChildOfClass("Humanoid")
			
			if not othersChar or not othersRootpart or not othersHumanoid then continue end
			
			local pos = othersRootpart.Position
			if pos.X >= XZ.minX and pos.X <= XZ.maxX and pos.Z >= XZ.minZ and pos.Z <= XZ.maxZ then continue end
			
			if othersHumanoid.Health <= 0 then continue end
			if Humanoid.Health <= 0 then return end
			
			local tool = Char and Char:FindFirstChildOfClass("Tool")
			local Handle = tool and tool:FindFirstChild("Handle")
			if not tool and Handle then return end 

			pcall(function()
				for _, hit in pairs(Handle:GetTouchingParts()) do
					if hit:IsA("BasePart") then
						
						local TargetChar = hit.Parent
						if TargetChar == Char then return end 

						for _ = 1, set.amp.damage do
							firetouchinterest(hit, Handle, 0)
							firetouchinterest(hit, Handle, 1)
						end
					end
				end
			end)
		end
	end
end

RunService.Heartbeat:Connect(function()
	UpdateCamAim() ampx()
	
	local char = player.Character
	local hrp = char and char:FindFirstChild("HumanoidRootPart")
	local humanoid = char and char:FindFirstChildOfClass("Humanoid")

	if char and hrp and humanoid then
		hrp.CFrame = hrp.CFrame + humanoid.MoveDirection * 0.01
	end
end)
